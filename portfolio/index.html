<!DOCTYPE html>
<html>

<head>
  <title>Scrolling Video Example</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #001A2C;
      color: white;
    }
    
    #v0 {
      border-radius: 20px;
      bottom: 0;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      position: absolute;
    }
    
    p font-family helvetica {
      font-size: 24px;
    }
    
    .divider {
      height: 10vh;
    }
    
    .video-section {
      position: relative;
      height: 330vh;
      display: block;
    }

    /* section {
      min-height: 300vh;
    } */

    .main {
      min-height: 500vh;
    }
  </style>
</head>

<body>

  <section class="video-section">
    <video id="v0" tabindex="0" autobuffer="autobuffer" preload="preload">
      <!-- <source type="video/mp4; codecs=&quot;avc1.42E01E, mp4a.40.2&quot;" src="https://www.apple.com/media/us/mac-pro/2013/16C1b6b5-1d91-4fef-891e-ff2fc1c1bb58/videos/macpro_main_desktop.mp4"></source> -->
      <source type="video/mp4" src="assets/switzerland.mp4">
      </source>
    </video>
  </section>

  <section class="divider"></section>

  <section class="main">
    <h1>Hello</h1>
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/ScrollTrigger.min.js"></script>
  <script>
    var frameNumber = 0,
      playbackConst = 500,
      setHeight = document.getElementById("set-height"),
      vid = document.getElementById('v0');

    // vid.addEventListener('loadedmetadata', function () {
    //   setHeight.style.height = Math.floor(vid.duration) * playbackConst + "px";
    // });

    function scrollPlay() {
      var frameNumber = window.pageYOffset / playbackConst;
      vid.currentTime = frameNumber;
      window.requestAnimationFrame(scrollPlay);
      // vid.style.position = vid.currentTime.toFixed(1) < frameNumber.toFixed(1) ? 'none' : 'fixed';
      console.log(vid.currentTime.toFixed(1) < frameNumber.toFixed(1));
    }

    gsap.registerPlugin(ScrollTrigger);

    /*ScrollTrigger.create({
      trigger: "section",
      start: "top top",
      end: "top top",
      scrub: true,
      markers: true,
      onUpdate: function (self) {
        var progress = self.progress;
        gsap.to(vid, { y: -progress * vid.offsetHeight });
      }
    });*/

    gsap.timeline({
      scrollTrigger: {
        // trigger: '#set-height',
        // endTrigger: '.divider',
        trigger: '.video-section',
        start: 'top top',
        end: 'bottom bottom',
        markers: true,
        scrub: true
      }
    }).from('.video-section', {
      y: 0,
    }).to('.video-section', {
      // opacity: 0,
    })


    window.requestAnimationFrame(scrollPlay);
  </script>
</body>

</html>